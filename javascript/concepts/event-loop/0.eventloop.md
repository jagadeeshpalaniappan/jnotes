# EventLoop Example Code

### 1.event-loop-execution.js

Event Loop

* Synchronous Code
* Asynchronous Code
  * Micro Task \(Fulfilled Promise, ...\)
    * will be executed **`before`** the `start of next event loop`
  * Macro Task \(setTimeout,...\)
    * will be executed **`after`** the `start of next event loop`
* 
```javascript
console.log('Line1: SynchronousCode');

setTimeout(_ => console.log(`Line2: TimeoutCode`), 0);  // not executed: added in queue for later execution

Promise.resolve().then(_ => console.log('Line3: PromiseCode')); // not executed: added in queue for later execution

console.log('Line4: SynchronousCode');

/*
  Line1: SynchronousCode
  Line4: SynchronousCode
  Line3: Promise AsyncCode    // why 'Line3' executed before 'Line2'?
  Line2: Timeout AsyncCode
*/


/*
## why 'Line3' executed before 'Line2'?
  - becoz 'Promises --> MicroTasks'  and  'Timeout --> MacroTasks'
  - MicroTasks: are getting executed before the next event loop start
  - MacroTasks: are getting executed after the next event loop start
*/
```

### 3.blocking-code-solve-using-timeout.js

```javascript
function blockingCode() {
  console.log('Line2: blockingCode--start');
  console.time("exeTime:blockingCode");

  let i = 0;
  while (i < 1000000000) { i++; }

  console.timeEnd("exeTime:blockingCode");
  console.log('Line2: blockingCode--end');
}

//------------------------------------------------------

// execute: the blockingCode aynchronously
// execute: the blockingCode --after all SynchronousCode

// soln: Using Promise

console.log('Line1: SynchronousCode');

setTimeout(() => {
  blockingCode();
});

console.log('Line3: SynchronousCode');
```

### 4.blocking-code-solve-using-promise--notCorrect.js

```javascript
function blockingCode() {
  console.log('Line2: blockingCode--start');
  console.time("exeTime:blockingCode");

  let i = 0;
  while (i < 1000000000) { i++; }

  console.timeEnd("exeTime:blockingCode");
  console.log('Line2: blockingCode--end');

}

//------------------------------------------------------

// execute: the blockingCode aynchronously
// execute: the blockingCode --after all SynchronousCode

// soln: Using Promise:
// This is worng solution // Why? 'inside: Promise block' is a **synchronous block** which execute immediately
// How do u fix? // Follow next file

console.log('Line1: SynchronousCode');

function executeLaterUsingPromise() {
  return new Promise((resolve, reject) => {
    // REMEMBER: This is synchronous block
    console.log('inside: Promise block');
    blockingCode();
  });
}
executeLaterUsingPromise(); 

console.log('Line3: SynchronousCode');

```

### 4.blocking-code-solve-using-promise.js

```javascript
function blockingCode() {
  console.log('Line2: blockingCode--start');
  console.time("exeTime:blockingCode");

  let i = 0;
  while (i < 1000000000) { i++; }

  console.timeEnd("exeTime:blockingCode");
  console.log('Line2: blockingCode--end');
}

//------------------------------------------------------

// execute: the blockingCode aynchronously
// execute: the blockingCode --after all SynchronousCode

// soln: Using Promise:
// This is worng solution // Why? 'inside: Promise block' is a **synchronous block** which execute immediately

console.log('Line1: SynchronousCode');

function executeLaterUsingPromise() {
  Promise.resolve().then(() => {
    // REMEMBER: This is NOT synchronous block
    console.log('inside: Promise.resolve block');
    blockingCode();
  });
}
executeLaterUsingPromise(); // This works as expected

console.log('Line3: SynchronousCode');

```

